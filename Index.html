<!DOCTYPE html>
<html lang="en">
<head>
  <base target="_top">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Automatically clean and organize your Gmail inbox with ease">
  <title>Email Cleanup Pro - Smart Gmail Automation</title>
  
  <!-- Include External Stylesheet -->
  <?!= HtmlService.createHtmlOutputFromFile('styles').getContent(); ?>
</head>
<body>
  <div class="container">
    <!-- Hero Header -->
    <header class="header">
      <div class="header-icon">ğŸ“§</div>
      <h1 class="header-title">Email Cleanup Pro</h1>
      <p class="header-description">Intelligent email management powered by automation</p>
      <div class="header-tags">
        <span class="tag">Smart</span>
        <span class="tag">Secure</span>
        <span class="tag">Simple</span>
      </div>
    </header>

    <!-- Alert Messages -->
    <div id="alertSuccess" class="alert alert-success">
      <span class="alert-icon">âœ“</span>
      <span class="alert-message"></span>
    </div>
    <div id="alertError" class="alert alert-error">
      <span class="alert-icon">âœ•</span>
      <span class="alert-message"></span>
    </div>

    <!-- Statistics Grid -->
    <section class="stats-section">
      <div class="grid grid-cols-3">
        <div class="stat-card">
          <div class="stat-icon">ğŸ“…</div>
          <div class="stat-value" id="statsToday">0</div>
          <div class="stat-label">Cleaned Today</div>
          <div class="stat-progress">
            <div class="progress-bar" style="width: 0%"></div>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">ğŸ“Š</div>
          <div class="stat-value" id="statsWeek">0</div>
          <div class="stat-label">This Week</div>
          <div class="stat-progress">
            <div class="progress-bar" style="width: 0%"></div>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">ğŸ¯</div>
          <div class="stat-value" id="statsTotal">0</div>
          <div class="stat-label">Total Cleaned</div>
          <div class="stat-progress">
            <div class="progress-bar" style="width: 100%"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Settings Card -->
    <div class="card card-elevated" style="margin-bottom: 1.5rem;">
      <div class="card-header">
        <div class="card-header-content">
          <div class="card-icon">âš™ï¸</div>
          <div>
            <h2 class="card-title">Configuration</h2>
            <p class="card-description">Customize your email cleanup preferences</p>
          </div>
        </div>
        <span class="badge badge-primary">Active</span>
      </div>
      <div class="card-content">
        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="daysOld">
              <span class="label-icon">ğŸ“†</span>
              Delete emails older than (days)
            </label>
            <input type="number" id="daysOld" class="form-input" value="30" min="1" max="365" placeholder="30">
            <span class="form-hint">Emails older than this will be processed</span>
          </div>

          <div class="form-group">
            <label class="form-label" for="action">
              <span class="label-icon">ğŸ¯</span>
              Action
            </label>
            <select id="action" class="form-select">
              <option value="trash">ğŸ—‘ï¸ Move to Trash</option>
              <option value="archive">ğŸ“¦ Archive</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label" for="searchQuery">
            <span class="label-icon">ğŸ”</span>
            Search Query
            <span class="label-badge">Advanced</span>
          </label>
          <input type="text" id="searchQuery" class="form-input" value="older_than:30d" placeholder="older_than:30d">
          <div class="form-hint">
            <strong>Examples:</strong>
            <div class="hint-examples">
              <code>category:promotions older_than:30d</code>
              <code>from:newsletter@example.com older_than:60d</code>
              <code>larger:5M older_than:90d</code>
            </div>
          </div>
        </div>

        <div class="divider"></div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="frequency">
              <span class="label-icon">â°</span>
              Automatic Schedule
            </label>
            <select id="frequency" class="form-select">
              <option value="none">ğŸš« Disabled</option>
              <option value="daily">ğŸ“… Daily at 2 AM</option>
              <option value="weekly">ğŸ“† Weekly (Monday)</option>
            </select>
          </div>

          <div class="form-group">
            <label class="form-label">
              <span class="label-icon">ğŸ”Œ</span>
              Enable Automatic Cleanup
            </label>
            <div class="toggle-wrapper">
              <label class="toggle">
                <input type="checkbox" id="enabled">
                <span class="toggle-slider"></span>
              </label>
              <span class="toggle-label">
                <span class="toggle-status" id="toggleStatus">Disabled</span>
              </span>
            </div>
          </div>
        </div>

        <div class="btn-group">
          <button class="btn btn-primary" onclick="saveSettings()">
            <span class="btn-icon">ğŸ’¾</span>
            Save Settings
          </button>
          <button class="btn btn-outline" onclick="loadSettings()">
            <span class="btn-icon">ğŸ”„</span>
            Reload
          </button>
        </div>
      </div>
    </div>

    <!-- Preview Card -->
    <div class="card card-elevated" style="margin-bottom: 1.5rem;">
      <div class="card-header">
        <div class="card-header-content">
          <div class="card-icon">ğŸ‘€</div>
          <div>
            <h2 class="card-title">Preview Emails</h2>
            <p class="card-description">Review emails before cleanup to avoid mistakes</p>
          </div>
        </div>
        <span class="badge badge-info">Safe</span>
      </div>
      <div class="card-content">
        <div class="info-box">
          <div class="info-icon">ğŸ’¡</div>
          <div class="info-text">
            <strong>Pro Tip:</strong> Always preview emails before running cleanup to ensure you're deleting the right content.
          </div>
        </div>

        <button class="btn btn-primary btn-lg" onclick="previewEmails()">
          <span class="btn-icon">ğŸ”</span>
          Preview Emails
        </button>
        
        <div class="loading" id="previewLoading">
          <div class="spinner"></div>
          <p class="loading-text">Fetching emails...</p>
        </div>
        
        <div id="previewResults"></div>
      </div>
    </div>

    <!-- Manual Cleanup Card -->
    <div class="card card-elevated card-danger" style="margin-bottom: 1.5rem;">
      <div class="card-header">
        <div class="card-header-content">
          <div class="card-icon">â–¶ï¸</div>
          <div>
            <h2 class="card-title">Manual Cleanup</h2>
            <p class="card-description">Execute cleanup immediately with current settings</p>
          </div>
        </div>
        <span class="badge badge-warning">Caution</span>
      </div>
      <div class="card-content">
        <div class="warning-box">
          <div class="warning-icon">âš ï¸</div>
          <div class="warning-text">
            <strong>Warning:</strong> This action will permanently move emails to trash. Make sure to preview first!
          </div>
        </div>

        <button class="btn btn-success btn-lg" onclick="runNow()">
          <span class="btn-icon">ğŸš€</span>
          Run Cleanup Now
        </button>
        
        <div class="loading" id="runLoading">
          <div class="spinner"></div>
          <p class="loading-text">Processing emails...</p>
          <p class="loading-subtext">This may take a few moments</p>
        </div>
      </div>
    </div>

    <!-- Activity Log Card -->
    <div class="card">
      <div class="card-header">
        <div class="card-header-content">
          <div class="card-icon">ğŸ“Š</div>
          <div>
            <h2 class="card-title">Activity Log</h2>
            <p class="card-description">Track all cleanup operations and history</p>
          </div>
        </div>
        <button class="btn btn-sm btn-outline" onclick="loadActivityLog()">
          <span class="btn-icon">ğŸ”„</span>
          Refresh
        </button>
      </div>
      <div class="card-content" style="padding: 0;">
        <div id="activityLog" class="list"></div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-content">
        <p>Made with â¤ï¸ by Email Cleanup Pro</p>
        <div class="footer-links">
          <a href="#" class="footer-link">Documentation</a>
          <span class="footer-separator">â€¢</span>
          <a href="#" class="footer-link">Privacy</a>
          <span class="footer-separator">â€¢</span>
          <a href="#" class="footer-link">Support</a>
        </div>
      </div>
    </footer>
  </div>

  <!-- Include External JavaScript -->
  <?!= HtmlService.createHtmlOutputFromFile('scripts').getContent(); ?>
</body>
</html>